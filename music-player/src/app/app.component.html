<div class="app-shell">
  <header class="app-header">
    <h1>Angular Music Player</h1>
    <p>Import your audio files and control playback directly in the browser.</p>
  </header>

  <section class="import-section">
    <label class="import-button">
      <input
        type="file"
        accept="audio/*"
        multiple
        (change)="onFilesSelected($event)"
      />
      <span>Add Songs</span>
    </label>
    <p class="import-hint">Supported formats depend on the browser (MP3, WAV, OGG, etc.).</p>
  </section>

  <section class="player-panel" *ngIf="tracks.length">
    <div class="now-playing">
      <div class="track-name" *ngIf="currentTrack as track; else idleState">
        {{ track.name }}
      </div>
      <ng-template #idleState>
        <div class="track-name">Select a track to start listening.</div>
      </ng-template>
    </div>

    <div class="timeline" [class.disabled]="!currentTrack">
      <span>{{ formatTime(currentTrack ? currentTime : 0) }}</span>
      <input
        type="range"
        [max]="currentTrack ? duration : 0"
        [value]="currentTrack ? currentTime : 0"
        step="0.1"
        (input)="onSeek($event)"
        [disabled]="!currentTrack"
      />
      <span>{{ formatTime(currentTrack ? duration : 0) }}</span>
    </div>

    <div class="transport">
      <button
        type="button"
        class="control"
        (click)="previousTrack()"
        [disabled]="currentTrackIndex <= 0"
      >
        &#9664;&#9664;
      </button>
      <button
        type="button"
        class="control primary"
        (click)="togglePlayback()"
        [disabled]="!tracks.length"
      >
        <ng-container *ngIf="isLoadingTrack">Loading…</ng-container>
        <ng-container *ngIf="!isLoadingTrack">
          {{ isPlaying ? 'Pause' : 'Play' }}
        </ng-container>
      </button>
      <button
        type="button"
        class="control"
        (click)="nextTrack()"
        [disabled]="currentTrackIndex === -1 || currentTrackIndex >= tracks.length - 1"
      >
        &#9654;&#9654;
      </button>
    </div>

    <div class="volume">
      <label for="volume">Volume</label>
      <input
        id="volume"
        type="range"
        min="0"
        max="1"
        step="0.01"
        [value]="volume"
        (input)="onVolumeChange($event)"
      />
    </div>
  </section>

  <section class="playlist" *ngIf="tracks.length; else emptyState">
    <h2>Playlist</h2>
    <ul>
      <li
        *ngFor="let track of tracks; index as i"
        (click)="playTrack(i)"
        [class.active]="isCurrentTrack(i)"
      >
        <div class="details">
          <span class="title">{{ track.name }}</span>
          <span class="duration">{{ trackDuration(track) }}</span>
        </div>
      </li>
    </ul>
  </section>

  <ng-template #emptyState>
    <div class="empty-state">
      <p>No songs yet. Use the <strong>Add Songs</strong> button to import your music.</p>
    </div>
  </ng-template>
</div>